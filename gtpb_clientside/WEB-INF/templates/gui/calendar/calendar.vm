##
##  Copyright 2011 GT webMarque Ltd
## 
##  This file is part of agileBase.
##
##  agileBase is free software: you can redistribute it and/or modify
##  it under the terms of the GNU General Public License as published by
##  the Free Software Foundation, either version 3 of the License, or
##  (at your option) any later version.
##  agileBase is distributed in the hope that it will be useful,
##  but WITHOUT ANY WARRANTY; without even the implied warranty of
##  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
##  GNU General Public License for more details.
##
##  You should have received a copy of the GNU General Public License
##  along with agileBase.  If not, see <http://www.gnu.org/licenses/>.
##
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Strict//EN">
#set($mobile_device = $sessionData.getCustomBoolean("mobile_device"))
#set($user = $view.getLoggedInUser())
#set($company=$user.getCompany())
<html>
<head>
  <link rel="icon" href="resources/icons/gtpb.ico" type="image/x-icon"> <!-- favicon -->
  <title>
    $company calendar
  </title>
  <link type="text/css" href="resources/fullcalendar/fullcalendar.css" rel="stylesheet" />
  <link type="text/css" href="customisations/common/dashboard/dashboard.css" rel="stylesheet" />
  <link type="text/css" href="resources/fullcalendar/calendar.css" rel="stylesheet" />
  <link type="text/css" href="resources/modalFramework/modalFramework.css" rel="stylesheet" />
  <script src="resources/jquery.js" language="Javascript"></script>
  <script src="resources/jquery.qtip.js" language="Javascript"></script>
  <script src="resources/wait/request_setFilter.js" language="Javascript"></script>
  <script src="resources/modalFramework/modalFramework.js" language="Javascript"></script>
  <script src="resources/fullcalendar/jquery-ui-custom.js" language="Javascript"></script>
  <script src="resources/fullcalendar/fullcalendar.js" language="Javascript"></script>
  <script src="resources/fullcalendar/calendar.js" language="Javascript"></script>
  <style>
  </style>
</head>
<body>
<div id="header">
  <a id="home" href="#" alt="agileBase"><img src="/agileBase/website/images/logo-agilebase.png"></a>
  <div id="links">
    <div class="button" style="left: 0px;">
		#if($mobile_device)
		#else
		  #set($databaseReturn = "gui/display_application")			
		#end
        <a href="?return=$databaseReturn">
    	  <img src="customisations/common/dashboard/panes.png" /><br>Database
    	</a>
		<div id="selected_reports">
		</div>
    </div>
  </div>
</div>
<div id="report_selection">
## Create a collection $moduleReports: each module maps to an array of reports
#parse("gui/resources/calc_module_reports.vm")
#if($moduleReports.size() > 0)
	<ul>
    #set($hiddenReports = $user.getHiddenReports())
    #foreach($module in $moduleReports.keySet())
	  #set($visibleModuleReports = $moduleReports.get($module))
	  #set($temp = $visibleModuleReports.removeAll($hiddenReports))
	  #if($visibleModuleReports.size() > 0)
    	#set($internalModuleName = $module.getInternalModuleName())
    	<li id="$internalModuleName">
    	  <h2><span><img src="resources/icons/applications/tango/$module.getIconPath()"/> 
    		$module
    	  </span></h2>
    	  <ul parent="$internalModuleName">
    	  #foreach($report in $visibleModuleReports) 
    		#set($table=$report.getParentTable())
			#set($internalReportName = $report.getInternalReportName())
    		<li id="$table.getInternalTableName()$internalReportName">
			  <input type="checkbox" internalreportname="$internalReportName" #if($sessionData.getCustomReport("calendar_$internalReportName")) checked #end> 
			  $report
    		</li>
    	  #end ## end of loop through reports in a module
    	  </ul>
    	</li>
      #end
	#end ## end loop through modules
	</ul>
#end ## end if there are any modules visible
</div>
<div id="calendar"></div>
</body>
</html>